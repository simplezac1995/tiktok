{extend name="base" /}{block name="body"}
<script type="text/javascript" charset="utf-8" src="/admin/js/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="/admin/js/ueditor/ueditor.all.js"></script>
<body>
<div class="ok-body">
	<form class="layui-form ok-form layui-form-pane" lay-filter="formFilter">
		<input type="hidden" name="id" />
		<div class="layui-form-item">
			<label class="layui-form-label">任务标题</label>
			<div class="layui-input-block">
				<input type="text" name="title" placeholder="请输入标题" autocomplete="off" class="layui-input" readonly="readonly">
			</div>
		</div>
		<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">任务人</label>
					<div class="layui-input-block">
					<input type="text" name="user" placeholder="请输入用户ID" autocomplete="off" class="layui-input" readonly="readonly">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">任务类型</label>
					<div class="layui-input-block">
						<input type="text" name="type" class="layui-input" readonly="readonly">
					</div>
				</div>
		</div>
		<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">任务等级</label>
				<div class="layui-input-block">
				<input type="text" name="vipcard" class="layui-input" readonly="readonly">
				</div>
			</div>
			<div class="layui-inline">
				<label class="layui-form-label">任务要求</label>
				<div class="layui-input-block">
				<input type="text" name="ask" class="layui-input" readonly="readonly">
				</div>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">悬赏金额</label>
			<div class="layui-input-block">
				<div class="layui-inline">
				<input type="text" name="money" placeholder="请选择悬赏金额" autocomplete="off" class="layui-input" readonly="readonly">
				</div>
				<div class="layui-inline">元</div>
			</div>
		</div>
		<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">申请时间</label>
				<div class="layui-input-block">
					<input type="text" name="create_time" class="layui-input" readonly="readonly">
				</div>
			</div>
			<div class="layui-inline">
				<label class="layui-form-label">提交时间</label>
				<div class="layui-input-block">
					<input type="text" name="submit_time" class="layui-input" readonly="readonly">
				</div>
				
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">任务链接</label>
			<div class="layui-input-block">
				<input type="text" name="link"autocomplete="off" class="layui-input" readonly="readonly">
			</div>
		</div>
		
		
		
		<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">状态</label>
				<div class="layui-input-block">
					<select name="status">
						<option value="">请选择</option>
						{foreach $Think.config.sys.task_apply_status as $key=>$val }
						<option value="{$key}">{$val}</option>
						{/foreach}
					</select>
				</div>
			</div>
		</div>
		
		<div class="layui-form-item layui-form-text">
			<label class="layui-form-label">备注</label>
			<div class="layui-input-block">
				<textarea id="memo" class="layui-textarea" name="memo"></textarea>
			</div>
		</div>
		
		
		
		
		<div class="layui-form-item">
			<div class="layui-input-block">
				<button type="button" id="save" class="layui-btn">立即提交</button>
			</div>
		</div>




	</form>
</div>
<script>
formPageInit({
	afterPageInit:function(){
		let layer = layui.layer;
		let okLayer = layui.okLayer;
		let okUtils = layui.okUtils;
		let $ = layui.jquery;
		
		var id = getQueryParam("id");
		$("#save").on("click",function(){
			var status = $("select[name=status]").val();
			if(!status){
				layer.msg('请选择状态');
				return;
			}
			var memo = $("input[name=memo]").val();
			okUtils.ajax("/taskApply/changeStatus", "post",{status:status,memo:memo,id:id}, true).done(function (res) {
				okLayer.greenTickMsg("修改成功", function () {
					parent.layer.close(parent.layer.getFrameIndex(window.name));
				});
			}).fail(function (error) {
			    console.log(error);
			});
		})
	}
})
</script>
</body>
{/block}
